<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <title>Aktivity spolku | Jan Zrzavý</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Přehled aktivit spolku Za záchranu rodného domu Jana Zrzavého.">
  <link rel="stylesheet" href="styles.css">

  <!-- Jemné doladění jen pro karty událostí (bez zásahu do styles.css) -->
  <style>
    .event-card .card__media { margin:0; overflow:hidden; }
    .event-card .card__media img { display:block; width:100%; height:220px; object-fit:cover; }
    .event-card .card__body { padding-top: .95rem; }
    .event-card .card__meta { margin-top: .1rem; }
    .event-card .event__date  { display:block; font-weight:700; }
    .event-card .event__place { display:block; margin-top:.2rem; font-weight:600; color: var(--color-muted,#666); }
    .event-card .event__desc  { margin-top: .6rem; }
  
    /* štítky */
    .event-card .label{
      font-weight:700;
      color: var(--color-dark,#222);
      margin-right:.35rem;
    }
  </style>
  
</head>
<body>

<!-- Header -->
<header class="header">
  <div class="container nav">
    <div class="nav__brand">
      <a href="index.html" class="nav__logo">
        <img src="https://raw.githubusercontent.com/langpaulmartin-stack/janzrzavy/main/Logo%20Spolku%20Za%20Z%C3%A1chranu%20Rodn%C3%A9ho%20Domu.png" alt="Logo Jan Zrzavý">
      </a>
      <a href="index.html" class="nav__orgname">Spolek Za záchranu rodného domu Jana Zrzavého</a>
    </div>

    <nav class="nav__links" aria-label="Hlavní navigace">
      <div class="menu-item has-dropdown">
        <button class="menu-trigger" aria-haspopup="true" aria-expanded="false">
          Jan Zrzavý
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
        </button>
        <div class="dropdown">
          <a href="jan-zrzavy.html#v-datech">V datech</a>
          <a href="jan-zrzavy.html#myslenky">Vzpomínky</a>
        </div>
      </div>

      <div class="menu-item has-dropdown">
        <button class="menu-trigger" aria-haspopup="true" aria-expanded="false">
          Místa
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path fill="currentColor" d="M7 10l5 5 5-5z"/></svg>
        </button>
        <div class="dropdown">
          <a href="okrouhlice.html">Okrouhlice</a>
          <a href="krucemburk.html">Krucemburk</a>
          <a href="camaret.html">Camaret-sur-Mer</a>
        </div>
      </div>

      <a href="aktuality.html">Aktuality</a>
      <a href="o-spolku.html#o-spolku">Cíle spolku</a>
      <a href="aktivity.html" aria-current="page">Aktivity</a>
      <a href="#kontakt">Kontakt</a>
    </nav>

    <button class="nav__toggle" id="navToggle" aria-expanded="false" aria-controls="mobileMenu" aria-label="Otevřít menu">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M3 6h18v2H3V6zm0 5h18v2H3v-2zm0 5h18v2H3v-2z"/></svg>
    </button>
  </div>

  <!-- Mobilní panel -->
  <nav class="nav__panel" id="mobileMenu" aria-label="Mobilní navigace" hidden>
    <details class="mobile-group">
      <summary>Jan Zrzavý</summary>
      <a href="jan-zrzavy.html#v-datech">V datech</a>
      <a href="jan-zrzavy.html#myslenky">Vzpomínky</a>
    </details>
    <details class="mobile-group">
      <summary>Místa</summary>
      <a href="okrouhlice.html">Okrouhlice</a>
      <a href="krucemburk.html">Krucemburk</a>
      <a href="camaret.html">Camaret-sur-Mer</a>
    </details>
    <a href="aktuality.html">Aktuality</a>
    <a href="o-spolku.html#o-spolku">Cíle spolku</a>
    <a href="aktivity.html" aria-current="page">Aktivity</a>
    <a href="#kontakt">Kontakt</a>
  </nav>
</header>

<main id="main">
  <!-- Hero -->
  <section class="section section--image" style="--bg-url: url('https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_6467_web.jpg');">
    <div class="container">
      <div class="kicker">Co děláme</div>
      <h1>Aktivity spolku</h1>
      <p class="mt-2">Podpora komunity, vydávání publikací a spolupráce s institucemi.</p>
      <div class="mt-3">
        <a class="btn" href="#rozvoj">Rozvoj komunity</a>
        <a class="btn btn--ghost" href="#vydavatelska">Vydavatelská činnost</a>
        <a class="btn btn--ghost" href="#partnerstvi">Partnerství</a>
      </div>
    </div>
  </section>

  <!-- Události (plánované) -->
  <section id="udalosti" class="section">
    <div class="container">
      <div class="kicker">Kalendář</div>
      <h2>Plánované události</h2>
      <div id="eventsUpcoming" class="grid grid--3 mt-3"></div>
      <div id="pagerUpcoming" class="mt-2"></div>
    </div>
  </section>

  <!-- Události (uplynulé) -->
  <section id="udalosti-minule" class="section">
    <div class="container">
      <div class="kicker">Kalendář</div>
      <h2>Uplynulé události</h2>

      <!-- Filtr roku -->
      <div class="filterbar mt-2" aria-label="Filtr uplynulých">
        <label for="pastYearFilter">Rok:</label>
        <select id="pastYearFilter">
          <option value="">Vše</option>
        </select>
      </div>

      <div id="eventsPast" class="grid grid--3 mt-3"></div>
      <div id="pagerPast" class="mt-2"></div>
    </div>
  </section>

  <!-- Rozvoj -->
  <section id="rozvoj" class="section">
    <div class="container">
      <div class="kicker">Aktivity</div>
      <h2>Rozvoj komunity a péče o rodný dům</h2>
      <p class="mt-2">Kulturní akce, vzdělávání a podpora identity regionu.</p>
    </div>
  </section>

  <!-- Vydavatelská činnost -->
  <section id="vydavatelska" class="section section--soft">
    <div class="container">
      <div class="kicker">Publikace</div>
      <h2>Vydavatelská činnost</h2>
      <p class="mt-2">Publikace věnované Zrzavému, regionu a historii.</p>

      <div class="grid grid--3 mt-3">
        <article class="card card--year">
          <figure class="card__media">
            <img src="https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/Stizny_list_titulka.jpg" alt="Stížný list – publikace">
          </figure>
          <div class="card__body">
            <h3 class="h5">Stížný list</h3>
            <div class="card__meta">Rok vydání: 2015</div>
            <p>Oceňovaná publikace připomínající historické události spojené s obcí Okrouhlice.</p>
          </div>
        </article>

        <article class="card card--year">
          <figure class="card__media">
            <img src="https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/lipnicka%20bible.jpg" alt="Lipnická bible – publikace">
          </figure>
          <div class="card__body">
            <h3 class="h5">Lipnická bible</h3>
            <div class="card__meta">Rok vydání: 2021</div>
            <p>Významné dílo propojující historii a kulturní odkaz regionu.</p>
          </div>
        </article>

        <article class="card card--year">
          <figure class="card__media">
            <img src="https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/jan-zrzavy-malir-basnik.jpg" alt="Jan Zrzavý – malíř básník – publikace">
          </figure>
          <div class="card__body">
            <h3 class="h5">Jan Zrzavý – malíř básník</h3>
            <div class="card__meta">Rok vydání: 2010</div>
            <p>Publikace věnovaná osobnosti a dílu Jana Zrzavého.</p>
          </div>
        </article>

        <article class="card card--year">
          <figure class="card__media">
            <img src="https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/chvilkyZrzavy.jpg" alt="Chvilky s Janem Zrzavým – publikace">
          </figure>
          <div class="card__body">
            <h3 class="h5">Chvilky s Janem Zrzavým</h3>
            <div class="card__meta">Rok vydání: 2012</div>
            <p>Sbírka textů a vzpomínek na malíře básníka.</p>
          </div>
        </article>

        <article class="card card--year">
          <figure class="card__media">
            <img src="https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/spory_o_jana_zizku.jpeg" alt="Spory o Jana Žižku – publikace">
          </figure>
          <div class="card__body">
            <h3 class="h5">Spory o Jana Žižku</h3>
            <div class="card__meta">Rok vydání: 2023</div>
            <p>Publikace reflektující historické a umělecké debaty.</p>
          </div>
        </article>

        <article class="card card--year">
          <figure class="card__media">
            <img src="https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/obalka_nahled.jpg" alt="Bohuslav Martinů a Jan Zrzavý – publikace">
          </figure>
          <div class="card__body">
            <h3 class="h5">Bohuslav Martinů a Jan Zrzavý</h3>
            <div class="card__meta">Rok vydání: 2014</div>
            <p>Kniha o přátelství a inspiraci dvou významných osobností.</p>
          </div>
        </article>
      </div>
    </div>
  </section>

  <!-- Partnerství -->
  <section id="partnerstvi" class="section">
    <div class="container">
      <div class="kicker">Spolupráce</div>
      <h2>Partnerství s institucemi</h2>
      <p class="mt-2">Spolupráce s muzei, galeriemi a dalšími organizacemi.</p>
    </div>
  </section>

  <section class="section">
    <div class="container section-cta">
      <a class="btn btn--outline" href="index.html">← Zpět na homepage</a>
      <a class="btn btn--outline" href="aktuality.html">Aktuality</a>
      <a class="btn btn--outline" href="o-spolku.html#o-spolku">O spolku</a>
    </div>
  </section>
</main>

<!-- Footer -->
<footer id="kontakt" class="footer">
  <div class="container footer__cols">
    <div>
      <strong>Za záchranu rodného domu Jana Zrzavého, z.s.</strong><br>
      582 31 Okrouhlice 62<br>
      IČ: 22725181
    </div>
    <div>
      <div><strong>Účet spolku</strong></div>
      <div>Č.ú.: 3807356001/5500</div>
      <div>IBAN: CZ8355000000003807356001</div>
      <div>SWIFT: RZBCCZPP</div>
    </div>
    <div>
      <div><strong>Odkazy</strong></div>
      <div class="mt-2">© <span id="year"></span> Martin Langpaul</div>
    </div>
  </div>
</footer>

<script>
// Rok v patičce
document.getElementById('year').textContent = new Date().getFullYear();

/** Mobile nav */
(function(){
  const btn = document.getElementById('navToggle');
  const panel = document.getElementById('mobileMenu');
  if(!btn || !panel) return;
  function openMenu(){ panel.hidden=false; panel.classList.add('open'); btn.setAttribute('aria-expanded','true'); btn.setAttribute('aria-label','Zavřít menu'); }
  function closeMenu(){ panel.classList.remove('open'); btn.setAttribute('aria-expanded','false'); btn.setAttribute('aria-label','Otevřít menu'); panel.hidden=true; }
  function toggleMenu(){ (btn.getAttribute('aria-expanded')==='true') ? closeMenu() : openMenu(); }
  btn.addEventListener('click', toggleMenu);
  panel.addEventListener('click', (e)=>{ if(e.target.tagName==='A'){ closeMenu(); } });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ closeMenu(); } });
  window.addEventListener('resize', ()=>{ if(window.innerWidth>900) closeMenu(); });
})();

/** Desktop dropdown */
(function(){
  document.querySelectorAll('.has-dropdown').forEach(dd=>{
    const btn = dd.querySelector('.menu-trigger');
    const menu = dd.querySelector('.dropdown');
    const open = ()=>{ dd.classList.add('open'); btn.setAttribute('aria-expanded','true'); };
    const close = ()=>{ dd.classList.remove('open'); btn.setAttribute('aria-expanded','false'); };
    const toggle = ()=>{ dd.classList.contains('open') ? close() : open(); };
    btn?.addEventListener('click', (e)=>{ e.preventDefault(); toggle(); });
    document.addEventListener('click', (e)=>{ if(!dd.contains(e.target)) close(); });
    dd.addEventListener('keydown', (e)=>{
      const items = Array.from(menu.querySelectorAll('a')); const idx = items.indexOf(document.activeElement);
      if(e.key==='Escape'){ close(); btn.focus(); }
      if(e.key==='ArrowDown'){ e.preventDefault(); open(); (items[idx+1]||items[0]).focus(); }
      if(e.key==='ArrowUp'){ e.preventDefault(); open(); (items[idx-1]||items[items.length-1]).focus(); }
    });
  });
})();

/** =========================
 *  Události (bez zásahu do globálního CSS)
 *  - používá .grid grid--3 + .card .card--year
 *  - stránkování pomocí .btn .btn--outline
 *  - filtr roku u uplynulých
 *  ========================= */
const EVENTS_DATA = [
  // Budoucí
  { t:"Jeníkova špacírka 2026", d:"2026-10-10T09:00", place:"Okrouhlice – start u školy", ex:"Trasy pro rodiny i nadšence, hudba, setkání.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_6467_web.jpg", url:"https://www.janzrzavy.cz/aktuality/" },
  { t:"REFRESH Jan Zrzavý 2026 – vernisáž", d:"2026-05-08T17:00", place:"Okrouhlice – Na skalce", ex:"Vernisáž studentské soutěže, hudba a hosté.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_6468_web.jpg", url:"https://www.janzrzavy.cz/aktuality/" },
  { t:"Letní koncert na zahradě", d:"2026-07-12T18:30", place:"Zahrada rodného domu", ex:"Komorní večer v kulisách zahrady.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_2050_slider%20(1).jpg", url:"https://www.janzrzavy.cz/aktuality/" },

  // Minulé
  { t:"REFRESH Jan Zrzavý 2025", d:"2025-05-06T17:00", place:"Okrouhlice – Na skalce", ex:"4. ročník soutěže – výběr prací.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_6468_web.jpg", url:"https://www.janzrzavy.cz/aktuality/refresh-jan-zrzavy-2025/" },
  { t:"Jeníkova špacírka 2025", d:"2025-09-18T09:00", place:"Okrouhlice", ex:"16. ročník – tradiční setkání a trasy.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/jenikova-spacirka-2018.png", url:"https://www.janzrzavy.cz/aktuality/pojdte-s-nami-na-16-jenikovu-spacirku/" },
  { t:"Vernisáž REFRESH 2024", d:"2024-10-20T17:00", place:"Okrouhlice – Na skalce", ex:"Vernisáž s autory.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/P1080807_slider_top.jpg", url:"https://www.janzrzavy.cz/aktuality/vernisaz-vystavy-refresh-jan-zrzavy-2024/" },
  { t:"Jeníkova špacírka 2024", d:"2024-09-22T09:00", place:"Okrouhlice", ex:"Trasy a setkání přátel regionu.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_2041.jpg", url:"https://www.janzrzavy.cz/aktuality/jenikova-spacirka-2022/" },
  { t:"REFRESH Jan Zrzavý 2024", d:"2024-05-04T17:00", place:"Okrouhlice", ex:"3. ročník – soutěžní přehlídka.", img:"https://raw.githubusercontent.com/langpaulmartin-stack/JZ-images/main/IMG_6467_web.jpg", url:"https://www.janzrzavy.cz/aktuality/refresh-jan-zrzavy-2024/" }
];

const PER_PAGE_UPCOMING = 6;
const PER_PAGE_PAST = 9;

const GRID_UP = document.getElementById("eventsUpcoming");
const GRID_PS = document.getElementById("eventsPast");
const PAGER_UP = document.getElementById("pagerUpcoming");
const PAGER_PS = document.getElementById("pagerPast");
const FILTER_PS = document.getElementById("pastYearFilter");
const TZ = "Europe/Prague";

function isFuture(iso){ return new Date(iso) > new Date(); }
function yearOf(iso){ return new Date(iso).getFullYear(); }
function czDateParts(iso){
  const d = new Date(iso);
  const date = d.toLocaleDateString("cs-CZ", { timeZone: TZ, day:"numeric", month:"long", year:"numeric" });
  const time = d.toLocaleTimeString("cs-CZ", { timeZone: TZ, hour:"2-digit", minute:"2-digit" });
  return {date, time};
}

function splitEvents(){
  const upcoming = EVENTS_DATA.filter(e => isFuture(e.d)).sort((a,b)=> a.d.localeCompare(b.d));
  const past     = EVENTS_DATA.filter(e => !isFuture(e.d)).sort((a,b)=> b.d.localeCompare(a.d));
  return {upcoming, past};
}

function cardHTML(e){
  const {date, time} = czDateParts(e.d);
  return `
  <article class="card card--year event-card">
        ${e.img ? `
        <figure class="card__media">
          <img src="${e.img}" alt="">
        </figure>` : ``}
        <div class="card__body">
          <div class="card__meta">
            <span class="event__date"><span class="label">Datum:</span>${date} • ${time}</span>
            ${e.place ? `<span class="event__place"><span class="label">Místo:</span>${e.place}</span>` : ``}
          </div>
          <h3 class="h4">${e.t}</h3>
          ${e.ex ? `<p class="event__desc">${e.ex}</p>` : ``}
          ${e.url ? `<a class="btn btn--outline mt-2" href="${e.url}" target="_blank" rel="noopener">Detail akce</a>` : ``}
        </div>
      </article>
  `;
}

function renderPager(container, pages, current, onGo){
  container.innerHTML = "";
  if(pages <= 1) return;
  const mk = (label, page, disabled=false, active=false)=>{
    const a = document.createElement("a");
    a.href="#";
    a.className = "btn btn--outline";
    a.textContent = label;
    if(disabled){ a.setAttribute("aria-disabled","true"); a.style.opacity=".6"; a.style.pointerEvents="none"; }
    if(active){ a.classList.add("is-active"); }
    a.addEventListener("click", e=>{ e.preventDefault(); onGo(page); });
    return a;
  };
  container.appendChild(mk("Předchozí", current-1, current===1));
  for(let i=1;i<=pages;i++) container.appendChild(mk(String(i), i, false, i===current));
  container.appendChild(mk("Další", current+1, current===pages));
}

let state = { upPage:1, pastPage:1, pastYear:"" };

function fillPastYears(past){
  const years = Array.from(new Set(past.map(e=>yearOf(e.d)))).sort((a,b)=> b-a);
  FILTER_PS.innerHTML = `<option value="">Vše</option>` + years.map(y=>`<option value="${y}">${y}</option>`).join("");
}

function renderAll(){
  const {upcoming, past} = splitEvents();

  // Plánované
  const upPages = Math.max(1, Math.ceil(upcoming.length / PER_PAGE_UPCOMING));
  state.upPage = Math.min(Math.max(1, state.upPage), upPages);
  const upStart = (state.upPage-1)*PER_PAGE_UPCOMING;
  const upSlice = upcoming.slice(upStart, upStart + PER_PAGE_UPCOMING);
  GRID_UP.innerHTML = upSlice.map(cardHTML).join("") || `<p>Momentálně nemáme žádné plánované události.</p>`;
  renderPager(PAGER_UP, upPages, state.upPage, p=>{ state.upPage = p; renderAll(); });

  // Uplynulé + filtr roku
  if(FILTER_PS && FILTER_PS.options.length <= 1){ fillPastYears(past); }
  const pastFiltered = past.filter(e => state.pastYear ? String(yearOf(e.d)) === state.pastYear : true);
  const psPages = Math.max(1, Math.ceil(pastFiltered.length / PER_PAGE_PAST));
  state.pastPage = Math.min(Math.max(1, state.pastPage), psPages);
  const psStart = (state.pastPage-1)*PER_PAGE_PAST;
  const psSlice = pastFiltered.slice(psStart, psStart + PER_PAGE_PAST);
  GRID_PS.innerHTML = psSlice.map(cardHTML).join("") || `<p>Zatím tu nejsou žádné uplynulé události.</p>`;
  renderPager(PAGER_PS, psPages, state.pastPage, p=>{ state.pastPage = p; renderAll(); });
}

FILTER_PS?.addEventListener("change", ()=>{
  state.pastYear = FILTER_PS.value;
  state.pastPage = 1;
  renderAll();
});

// Start
renderAll();
</script>
</body>
</html>
